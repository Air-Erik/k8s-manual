# Kubernetes –Ω–∞ vSphere —Å NSX-T (–±–µ–∑ Tanzu)

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤ –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è **production-ready Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞** –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö VMware vSphere —Å —Å–µ—Ç–µ–≤—ã–º underlay –Ω–∞ NSX-T.

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π Kubernetes-–∫–ª–∞—Å—Ç–µ—Ä (kubeadm) –Ω–∞ VM –ø–æ–¥ vSphere, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π NSX-T –∫–∞–∫ underlay-—Å–µ—Ç—å (–±–µ–∑ NCP), —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
- HA Control Plane (kube-vip)
- CNI: Cilium
- LoadBalancer: MetalLB (L2)
- Ingress: NGINX
- Storage: vSphere CSI
- Observability: metrics-server, Prometheus/Grafana (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- Backup: Velero + etcd snapshots

## üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ù–∞—á–Ω–∏—Ç–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
- **[k8s-on-vsphere-nsx-context.md](./k8s-on-vsphere-nsx-context.md)** ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Ä–µ—à–µ–Ω–∏—è, —Ä–∏—Å–∫–∏

**–ü–æ—à–∞–≥–æ–≤—ã–µ –º–∞–Ω—É–∞–ª—ã:**
1. `docs/01-nsx-network-setup.md` ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ NSX-T (Segment, IP-–ø–ª–∞–Ω, DFW, SpoofGuard)
2. `docs/02-vm-preparation.md` ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VM-—à–∞–±–ª–æ–Ω–æ–≤ (Ubuntu 24.04, containerd, sysctl)
3. `docs/03-cluster-bootstrap.md` ‚Äî kubeadm init, kube-vip, join workers
4. `docs/04-cni-setup.md` ‚Äî –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Cilium
5. `docs/05-storage-setup.md` ‚Äî vSphere CSI Driver
6. `docs/06-metallb-setup.md` ‚Äî MetalLB LoadBalancer
7. `docs/07-ingress-setup.md` ‚Äî NGINX Ingress Controller
8. `docs/08-observability-setup.md` ‚Äî –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏
9. `docs/09-backup-setup.md` ‚Äî Velero –∏ etcd backups
10. `docs/10-testing-validation.md` ‚Äî –¢–µ—Å—Ç–æ–≤—ã–µ workloads –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
11. `docs/99-troubleshooting.md` ‚Äî –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
k8s-manual/
‚îú‚îÄ‚îÄ README.md                          # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ k8s-on-vsphere-nsx-context.md      # –ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã (–∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏)
‚îú‚îÄ‚îÄ PROJECT-PLAN.md                    # –ú–∞—Å—Ç–µ—Ä-–ø–ª–∞–Ω –ø—Ä–æ–µ–∫—Ç–∞ —Å —ç—Ç–∞–ø–∞–º–∏
‚îú‚îÄ‚îÄ HOW-TO-DELEGATE-TO-AI.md          # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å AI-–∞–≥–µ–Ω—Ç–∞–º–∏
‚îÇ
‚îú‚îÄ‚îÄ docs/                              # –ü–æ—à–∞–≥–æ–≤—ã–µ –º–∞–Ω—É–∞–ª—ã
‚îú‚îÄ‚îÄ research/                          # –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ nsx-analysis/                  # NSX-T investigation (ACTIVE)
‚îú‚îÄ‚îÄ manifests/                         # Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã (–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º)
‚îú‚îÄ‚îÄ scripts/                           # Bash-—Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ nsx-configs/                       # –û–ø–∏—Å–∞–Ω–∏—è NSX-T –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
‚îî‚îÄ‚îÄ vm-templates/                      # Cloud-init –∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ VM
```

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –†–µ—à–µ–Ω–∏–µ | –í–µ—Ä—Å–∏—è |
|-----------|---------|--------|
| **Kubernetes** | kubeadm | 1.34.x |
| **–û–° –Ω–æ–¥** | Ubuntu | 24.04 LTS |
| **Container Runtime** | containerd | latest stable |
| **CNI** | Cilium | latest stable |
| **LoadBalancer** | MetalLB | L2 mode |
| **Ingress** | NGINX Ingress | latest stable |
| **CSI** | vSphere CSI Driver | compatible with vSphere 8.0 |
| **API HA** | kube-vip | latest stable |
| **Observability** | metrics-server | latest stable |
| **Backup** | Velero + etcdctl | latest stable |

**–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- vSphere 8.0.3.00500
- NSX-T 4.2.3.0.0

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### üìç –¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø: NSX-T Investigation (–≠—Ç–∞–ø 0.1)

**–°—Ç–∞—Ç—É—Å:** üü° –ì–æ—Ç–æ–≤–æ –∫ –ø–µ—Ä–µ–¥–∞—á–µ AI-–∞–≥–µ–Ω—Ç—É

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å:**
1. **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ** [k8s-on-vsphere-nsx-context.md](./k8s-on-vsphere-nsx-context.md) –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
2. **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ** [HOW-TO-DELEGATE-TO-AI.md](./HOW-TO-DELEGATE-TO-AI.md) ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å AI-–∞–≥–µ–Ω—Ç–∞–º–∏
3. **–ü–µ—Ä–µ–¥–∞–π—Ç–µ –∑–∞–¥–∞—á—É AI-–∞–≥–µ–Ω—Ç—É:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª [research/nsx-analysis/AI-AGENT-TASK.md](./research/nsx-analysis/AI-AGENT-TASK.md)
   - –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏–∑ HOW-TO-DELEGATE-TO-AI.md
   - AI-–∞–≥–µ–Ω—Ç —Å–æ–∑–¥–∞—Å—Ç –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –ø–æ–º–æ–∂–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å NSX
4. **–ü–æ—Å–ª–µ NSX setup:** –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ VM preparation

---

### –≠—Ç–∞–ø 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)
1. ~~–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç~~ ‚úÖ
2. **‚Üí –ù–∞—Å—Ç—Ä–æ–π—Ç–µ NSX-T —Å–µ—Ç—å: `docs/01-nsx-network-setup.md`** ‚¨ÖÔ∏è –í–´ –ó–î–ï–°–¨
3. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ VM-—à–∞–±–ª–æ–Ω—ã: `docs/02-vm-preparation.md`

### –≠—Ç–∞–ø 1: Bootstrap –∫–ª–∞—Å—Ç–µ—Ä–∞ (PoC)
4. –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ Control Plane: `docs/03-cluster-bootstrap.md`
5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ CNI (Cilium): `docs/04-cni-setup.md`
6. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Storage (CSI): `docs/05-storage-setup.md`
7. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ MetalLB: `docs/06-metallb-setup.md`
8. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ingress: `docs/07-ingress-setup.md`

### –≠—Ç–∞–ø 2: Production-–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å
9. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: `docs/08-observability-setup.md`
10. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ backup: `docs/09-backup-setup.md`
11. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã: `docs/10-testing-validation.md`

## ‚öôÔ∏è –†–∞–∑–º–µ—Ä—ã –í–ú (Dev/PoC)

**Control Plane (3 –Ω–æ–¥—ã):**
- 2 vCPU, 8 GB RAM, 80 GB Disk

**Workers (2+ –Ω–æ–¥—ã):**
- 4 vCPU, 16 GB RAM, 100 GB Disk

> –î–ª—è Prod-–∫–ª–∞—Å—Ç–µ—Ä–∞ Control Plane —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è –¥–æ 4 vCPU / 16 GB RAM.

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- NSX-T DFW –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –≥—Ä—É–ø–ø—ã `k8s-nodes`
- SpoofGuard whitelist –¥–ª—è VIP –∏ MetalLB IP
- NetworkPolicy –≤ Cilium
- Pod Security Admission (PSA) ‚Äî TBD —É—Ä–æ–≤–µ–Ω—å
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ etcd snapshots –∏ Velero backups

## üìä –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

- [ ] –ö–ª–∞—Å—Ç–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ API VIP
- [ ] –í—Å–µ –Ω–æ–¥—ã –≤ —Å—Ç–∞—Ç—É—Å–µ **Ready**
- [ ] –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ PVC —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Service LoadBalancer –ø–æ–ª—É—á–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–µ IP
- [ ] Ingress –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –ø–æ host/path
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `kubectl top`
- [ ] Velero/etcd backups –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã

## ü§ù –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **AI Team Lead** —Å –ø–æ–º–æ—â—å—é AI-–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π:
1. Team Lead —Å–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á–∏ –≤ –≤–∏–¥–µ `.md` –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
2. AI-–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã, —Å–∫—Ä–∏–ø—Ç—ã, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
3. –û–ø–µ—Ä–∞—Ç–æ—Ä-—á–µ–ª–æ–≤–µ–∫ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∫ —Ä–µ–∞–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ
4. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ feedback –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–π

**–í—Å–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã** –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è Prod-–∫–ª–∞—Å—Ç–µ—Ä–∞.

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `docs/99-troubleshooting.md`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∏—Å–∫–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ 10 –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
3. –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (MTU, SpoofGuard, DFW)

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-17
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0
**–°—Ç–∞—Ç—É—Å:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é Dev-–∫–ª–∞—Å—Ç–µ—Ä–∞
