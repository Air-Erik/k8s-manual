# VM Preparation and Template Creation

> **–°—Ç–∞—Ç—É—Å:** üü¢ COMPLETED (Template –≥–æ—Ç–æ–≤)
> **–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:** AI-–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å + –û–ø–µ—Ä–∞—Ç–æ—Ä
> **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** ‚úÖ NSX-T —Å–µ–≥–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω (01-nsx-network-setup.md)

---

## üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é VM Template Ubuntu 24.04 LTS —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ Kubernetes –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–¥ –∫–ª–∞—Å—Ç–µ—Ä–∞.

### üëâ –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
**[research/vm-preparation/AI-AGENT-TASK.md](../research/vm-preparation/AI-AGENT-TASK.md)**

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –ê–Ω–∞–ª–∏–∑ –≤–µ—Ä—Å–∏–π –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è VM Template
- –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- Cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –Ω–æ–¥
- –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã

---

## –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∏–∑ NSX-T)

**–°–µ—Ç–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–≥–æ—Ç–æ–≤—ã ‚úÖ):**
- **Segment:** `k8s-zeon-dev-segment`
- **Subnet:** `10.246.10.0/24`
- **Gateway:** `10.246.10.1`
- **Control Plane IPs:** `10.246.10.10-12`
- **Worker IPs:** `10.246.10.20-30`
- **API VIP:** `10.246.10.100`

**–†–∞–∑–º–µ—Ä—ã VM (–¥–ª—è PoC):**
- **Control Plane:** 2 vCPU, 8 GB RAM, 80 GB Disk
- **Workers:** 4 vCPU, 16 GB RAM, 100 GB Disk

---

## –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –Ω–∞ –≤—ã—Ö–æ–¥–µ

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å AI-–∞–≥–µ–Ω—Ç–æ–º:

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] **–î–µ—Ç–∞–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ** –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞ –≥–æ—Ç–æ–≤–æ ‚úÖ
- [x] **–ê–Ω–∞–ª–∏–∑ –≤–µ—Ä—Å–∏–π** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (K8s, containerd, Ubuntu) ‚úÖ
- [x] **–°—Ç—Ä–∞—Ç–µ–≥–∏—è Template** (–µ–¥–∏–Ω—ã–π Template –¥–ª—è –≤—Å–µ—Ö –Ω–æ–¥) ‚úÖ
- [x] **–ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏** —Å–æ–∑–¥–∞–Ω–∏—è VM –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ ‚úÖ
- [x] **–í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã** –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ
- [x] **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –≤ `research/vm-preparation/` (8 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤) ‚úÖ

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
- [x] **VM Template** —Å–æ–∑–¥–∞–Ω –≤ vSphere –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω ‚úÖ
- [x] **–°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:** ‚úÖ
  - `scripts/prepare-vm.sh` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ ‚úÖ
  - `scripts/validate-vm-template.sh` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è Template ‚úÖ
  - `scripts/cleanup-vm-for-template.sh` ‚Äî –æ—á–∏—Å—Ç–∫–∞ –ø–µ—Ä–µ–¥ Template ‚úÖ
- [x] **Cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** ‚úÖ
  - `vm-templates/cloud-init-base.yaml` ‚Äî –±–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ‚úÖ
  - `vm-templates/cloud-init-control-plane.yaml` ‚Äî –¥–ª—è CP –Ω–æ–¥ ‚úÖ
  - `vm-templates/cloud-init-worker.yaml` ‚Äî –¥–ª—è Worker –Ω–æ–¥ ‚úÖ
  - `vm-templates/examples/README.md` ‚Äî –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ‚úÖ
- [x] **–°–ø—Ä–∞–≤–æ—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã:** ‚úÖ
  - `vm-templates/packages-list.txt` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ ‚úÖ
  - `vm-templates/sysctl-settings.conf` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ sysctl ‚úÖ

---

## –ó–∞–¥–∞—á–∏

### –≠—Ç–∞–ø 1: –ê–Ω–∞–ª–∏–∑ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (COMPLETED ‚úÖ)
- [x] AI-–∞–≥–µ–Ω—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Kubernetes (–≤—ã–±—Ä–∞–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)
- [x] AI-–∞–≥–µ–Ω—Ç –æ–ø—Ä–µ–¥–µ–ª–∏–ª —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤–µ—Ä—Å–∏–∏ containerd, Ubuntu
- [x] AI-–∞–≥–µ–Ω—Ç —Å–æ–∑–¥–∞–ª —Å—Ç—Ä–∞—Ç–µ–≥–∏—é Template (–µ–¥–∏–Ω—ã–π Template –¥–ª—è –≤—Å–µ—Ö –Ω–æ–¥)

### –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (COMPLETED ‚úÖ)
- [x] AI-–∞–≥–µ–Ω—Ç —Å–æ–∑–¥–∞–ª –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–π VM
- [x] AI-–∞–≥–µ–Ω—Ç –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª –ø—Ä–æ—Ü–µ—Å—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ K8s –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [x] AI-–∞–≥–µ–Ω—Ç —Å–æ–∑–¥–∞–ª –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ Template

### –≠—Ç–∞–ø 3: –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (COMPLETED ‚úÖ)
- [x] AI-–∞–≥–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–ª —Å–∫—Ä–∏–ø—Ç `prepare-vm.sh` (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
- [x] AI-–∞–≥–µ–Ω—Ç —Å–æ–∑–¥–∞–ª –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
- [x] AI-–∞–≥–µ–Ω—Ç —Å–æ–∑–¥–∞–ª —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏ –¥–ª—è Template

### –≠—Ç–∞–ø 4: Cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (COMPLETED ‚úÖ)
- [x] AI-–∞–≥–µ–Ω—Ç —Å–æ–∑–¥–∞–ª –±–∞–∑–æ–≤—É—é cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- [x] AI-–∞–≥–µ–Ω—Ç —Å–æ–∑–¥–∞–ª —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è CP –∏ Workers
- [x] AI-–∞–≥–µ–Ω—Ç –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –≠—Ç–∞–ø 5: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è (COMPLETED ‚úÖ)
- [x] –û–ø–µ—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–ª –±–∞–∑–æ–≤—É—é VM –≤ vSphere (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ `k8s-zeon-dev-segment`)
- [x] –û–ø–µ—Ä–∞—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω–∏–ª —Å–∫—Ä–∏–ø—Ç `prepare-vm.sh`
- [x] –û–ø–µ—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–ª VM Template –≤ vSphere
- [x] –û–ø–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –ø–µ—Ä–≤–æ–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å cloud-init
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ kubeadm init

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

–ï—Å–ª–∏ —Ç—ã AI-–∞–≥–µ–Ω—Ç, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –Ω–∞ —ç—Ç—É –∑–∞–¥–∞—á—É:

1. **–ü—Ä–æ—á–∏—Ç–∞–π** [research/vm-preparation/AI-AGENT-TASK.md](../research/vm-preparation/AI-AGENT-TASK.md)
2. **–ù–∞—á–Ω–∏ —Å –≠—Ç–∞–ø–∞ 1** (–ê–Ω–∞–ª–∏–∑ –≤–µ—Ä—Å–∏–π –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π)
3. **–°–æ–∑–¥–∞–≤–∞–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã** –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (01, 02, 03, ...)
4. **–ü–∏—à–∏ –≥–æ—Ç–æ–≤—ã–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–∫—Ä–∏–ø—Ç—ã** (–±–µ–∑ TODO)
5. **–£—á–∏—Ç—ã–≤–∞–π Ubuntu 24.04** —Å–ø–µ—Ü–∏—Ñ–∏–∫—É

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏

–ó–∞–¥–∞—á–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–π, –∫–æ–≥–¥–∞:

‚úÖ **Template –≥–æ—Ç–æ–≤:** VM Template —Å–æ–∑–¥–∞–Ω –≤ vSphere —Å–æ –≤—Å–µ–º–∏ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç:** —Å–∫—Ä–∏–ø—Ç—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞—é—Ç VM
‚úÖ **Cloud-init –Ω–∞—Å—Ç—Ä–æ–µ–Ω:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ IP/hostname –ø—Ä–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–π–¥–µ–Ω–∞:** –ø–µ—Ä–≤—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª–æ–Ω —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è:** –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ—à–∞–≥–æ–≤—ã–µ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–µ
‚úÖ **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ kubeadm:** VM –≥–æ—Ç–æ–≤–∞ –∫ `kubeadm init` –∏ `kubeadm join`

**üéâ –í–°–ï –ö–†–ò–¢–ï–†–ò–ò –í–´–ü–û–õ–ù–ï–ù–´! –≠–¢–ê–ü 0.2 –ó–ê–í–ï–†–®–Å–ù!**

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –≠—Ç–∞–ø 1.1 ‚Äî Cluster Bootstrap (`docs/03-cluster-bootstrap.md`)
