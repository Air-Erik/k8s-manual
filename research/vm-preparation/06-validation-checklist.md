# –ß–µ–∫-–ª–∏—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ VM Template

> **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-27
> **–°—Ç–∞—Ç—É—Å:** ‚úÖ COMPLETED
> **AI-–∞–≥–µ–Ω—Ç:** VM Preparation Specialist

---

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ VM Template –¥–ª—è Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞.

**–¶–µ–ª—å:** –û–±–µ—Å–ø–µ—á–∏—Ç—å, —á—Ç–æ Template –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Production-ready Kubernetes –Ω–æ–¥.

---

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ
- ‚úÖ vSphere Client –¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ Template —Å–æ–∑–¥–∞–Ω –≤ vSphere
- ‚úÖ SSH –¥–æ—Å—Ç—É–ø –∫ —Ç–µ—Å—Ç–æ–≤–æ–π VM
- ‚úÖ –°–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø –∫ VM

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ SSH –∫–ª–∏–µ–Ω—Ç
- ‚úÖ kubectl (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ—Ä—Å–∏–π)
- ‚úÖ –°–∫—Ä–∏–ø—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (`scripts/validate-vm-template.sh`)

---

## –≠—Ç–∞–ø 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ Template –≤ vSphere

### 1.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è Template

- [ ] ‚úÖ Template —Å–æ–∑–¥–∞–Ω –≤ vSphere
- [ ] ‚úÖ –ò–º—è Template: `k8s-ubuntu2404-template`
- [ ] ‚úÖ Template –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ
- [ ] ‚úÖ Template –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
- [ ] ‚úÖ –†–∞–∑–º–µ—Ä Template —Ä–∞–∑—É–º–Ω—ã–π (~80 GB)

### 1.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö Template

- [ ] ‚úÖ –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è `k8s.template.version`: `1.0`
- [ ] ‚úÖ –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è `k8s.template.os`: `Ubuntu 24.04 LTS`
- [ ] ‚úÖ –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è `k8s.template.k8s.version`: `1.31.2`
- [ ] ‚úÖ –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è `k8s.template.containerd.version`: `1.7.18`
- [ ] ‚úÖ –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è `k8s.template.created`: `2025-01-27`
- [ ] ‚úÖ –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è `k8s.template.purpose`: `Kubernetes nodes (CP + Workers)`

---

## –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π VM

### 2.1. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Å—Ç–æ–≤–æ–π VM

- [ ] ‚úÖ –ò–º—è VM: `k8s-test-node`
- [ ] ‚úÖ –†–∞–∑–º–µ—Ä—ã: 2 vCPU, 8 GB RAM, 80 GB Disk
- [ ] ‚úÖ –°–µ—Ç—å: `k8s-zeon-dev-segment`
- [ ] ‚úÖ IP: `10.246.10.250` (–≤—Ä–µ–º–µ–Ω–Ω—ã–π)
- [ ] ‚úÖ Cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞

### 2.2. Cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∞

```yaml
#cloud-config
hostname: k8s-test-node
fqdn: k8s-test-node.zeon-dev.local

users:
  - name: k8s-admin
    sudo: ALL=(ALL) NOPASSWD:ALL
    shell: /bin/bash
    groups: [adm, systemd-journal, docker]
    ssh_authorized_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC... operator@workstation
    home: /home/k8s-admin
    create_home: true

write_files:
  - path: /etc/netplan/01-static-ip.yaml
    content: |
      network:
        version: 2
        ethernets:
          ens192:
            addresses: [10.246.10.250/24]
            gateway4: 10.246.10.1
            nameservers:
              addresses: [172.17.10.3, 8.8.8.8]
            dhcp4: false
            dhcp6: false
    permissions: '0644'
    owner: root:root

runcmd:
  - netplan apply
  - modprobe overlay
  - modprobe br_netfilter
  - sysctl --system
  - timedatectl set-timezone UTC
  - systemctl enable containerd
  - systemctl start containerd
  - systemctl enable kubelet
  - systemctl daemon-reload
  - apt clean
  - mkdir -p /home/k8s-admin/.ssh
  - chmod 700 /home/k8s-admin/.ssh
  - chown k8s-admin:k8s-admin /home/k8s-admin/.ssh

final_message: |
  ==========================================
  üéâ Kubernetes Test VM –≥–æ—Ç–æ–≤–∞!
  ==========================================

  –•–æ—Å—Ç: k8s-test-node
  IP: 10.246.10.250
  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: k8s-admin

  –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
  1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: ssh k8s-admin@10.246.10.250
  2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é: ./scripts/validate-vm-template.sh

  ==========================================
```

---

## –≠—Ç–∞–ø 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 3.1. SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Ç–µ—Å—Ç–æ–≤–æ–π VM
ssh k8s-admin@10.246.10.250

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å hostname
hostname
# –û–∂–∏–¥–∞–µ—Ç—Å—è: k8s-test-node

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å IP –∞–¥—Ä–µ—Å
ip addr show
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 10.246.10.250/24

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å gateway
ip route show
# –û–∂–∏–¥–∞–µ—Ç—Å—è: default via 10.246.10.1
```

### 3.2. –°–µ—Ç–µ–≤–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DNS
nslookup google.com
# –û–∂–∏–¥–∞–µ—Ç—Å—è: —Ä–µ–∑–æ–ª–≤–∏–Ω–≥ –≤ IP

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø
ping -c 3 8.8.8.8
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ø–∞–∫–µ—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ vCenter
curl -k https://<vcenter-ip>
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –æ—Ç–≤–µ—Ç –æ—Ç vCenter
```

---

## –≠—Ç–∞–ø 4: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

### 4.1. –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```bash
# –°–∫–∞—á–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏
wget https://raw.githubusercontent.com/your-repo/scripts/validate-vm-template.sh
chmod +x validate-vm-template.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é
./validate-vm-template.sh
```

### 4.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –í–µ—Ä—Å–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- ‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- ‚úÖ –°–µ—Ä–≤–∏—Å—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

**–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏:**
- ‚ùå –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
- ‚ùå –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é
- ‚ùå –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

---

## –≠—Ç–∞–ø 5: –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 5.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é –û–°
lsb_release -a
# –û–∂–∏–¥–∞–µ—Ç—Å—è: Ubuntu 24.04 LTS

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
uname -m
# –û–∂–∏–¥–∞–µ—Ç—Å—è: x86_64

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é —è–¥—Ä–∞
uname -r
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 6.8.x
```

### 5.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å swap
free -h
# –û–∂–∏–¥–∞–µ—Ç—Å—è: Swap = 0B

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å IP forwarding
sysctl net.ipv4.ip_forward
# –û–∂–∏–¥–∞–µ—Ç—Å—è: net.ipv4.ip_forward = 1

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å bridge netfilter
sysctl net.bridge.bridge-nf-call-iptables
# –û–∂–∏–¥–∞–µ—Ç—Å—è: net.bridge.bridge-nf-call-iptables = 1

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–¥—É–ª–∏ —è–¥—Ä–∞
lsmod | grep overlay
lsmod | grep br_netfilter
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
```

### 5.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ containerd

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é containerd
containerd --version
# –û–∂–∏–¥–∞–µ—Ç—Å—è: containerd.io 1.7.18

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å containerd
sudo systemctl status containerd
# –û–∂–∏–¥–∞–µ—Ç—Å—è: active (running)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é containerd
sudo cat /etc/containerd/config.toml | grep SystemdCgroup
# –û–∂–∏–¥–∞–µ—Ç—Å—è: SystemdCgroup = true
```

### 5.4. –ü—Ä–æ–≤–µ—Ä–∫–∞ Kubernetes –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é kubeadm
kubeadm version
# –û–∂–∏–¥–∞–µ—Ç—Å—è: v1.31.2

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é kubelet
kubelet --version
# –û–∂–∏–¥–∞–µ—Ç—Å—è: v1.31.2

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é kubectl
kubectl version --client
# –û–∂–∏–¥–∞–µ—Ç—Å—è: v1.31.2

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å kubelet
sudo systemctl status kubelet
# –û–∂–∏–¥–∞–µ—Ç—Å—è: enabled, –Ω–æ –Ω–µ running (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
```

### 5.5. –ü—Ä–æ–≤–µ—Ä–∫–∞ CNI plugins

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É CNI plugins
ls /opt/cni/bin/
# –û–∂–∏–¥–∞–µ—Ç—Å—è: bridge, host-local, loopback, portmap, tuning, etc.

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
ls -la /opt/cni/bin/
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã
```

---

## –≠—Ç–∞–ø 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ cloud-init

### 6.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ cloud-init

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é cloud-init
cloud-init --version
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 24.1.x

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å cloud-init
sudo systemctl status cloud-init
# –û–∂–∏–¥–∞–µ—Ç—Å—è: active (running)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ cloud-init
sudo journalctl -u cloud-init
# –û–∂–∏–¥–∞–µ—Ç—Å—è: —É—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
```

### 6.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ cloud-init

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo cat /etc/cloud/cloud.cfg
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
id k8s-admin
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –∫–ª—é—á–∏
ls -la /home/k8s-admin/.ssh/
# –û–∂–∏–¥–∞–µ—Ç—Å—è: authorized_keys —Ñ–∞–π–ª
```

---

## –≠—Ç–∞–ø 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ kubeadm

### 7.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ kubelet –Ω–µ –∑–∞–ø—É—â–µ–Ω (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è Template)
sudo systemctl status kubelet
# –û–∂–∏–¥–∞–µ—Ç—Å—è: enabled, –Ω–æ –Ω–µ running

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é kubelet
sudo cat /etc/systemd/system/kubelet.service.d/10-kubeadm.conf
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å containerd socket
ls -la /var/run/containerd/containerd.sock
# –û–∂–∏–¥–∞–µ—Ç—Å—è: socket —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

### 7.2. –¢–µ—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ kubeadm init

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
sudo kubeadm config images list
# –û–∂–∏–¥–∞–µ—Ç—Å—è: —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞–∑–æ–≤ Kubernetes

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π
sudo kubeadm version
# –û–∂–∏–¥–∞–µ—Ç—Å—è: v1.31.2

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
sudo kubeadm init --dry-run
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –æ—à–∏–±–æ–∫
```

---

## –≠—Ç–∞–ø 8: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 8.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h
# –û–∂–∏–¥–∞–µ—Ç—Å—è: —Ä–∞–∑—É–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (~80 GB)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–µ –º–µ—Å—Ç–æ
df -h / | awk 'NR==2 {print $4}'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã
```

### 8.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—â—É—é –ø–∞–º—è—Ç—å
free -h
# –û–∂–∏–¥–∞–µ—Ç—Å—è: ~8 GB

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—É—é –ø–∞–º—è—Ç—å
free -h | awk 'NR==2 {print $7}'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è Kubernetes
```

### 8.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ CPU

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ CPU
nproc
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 2

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É CPU
top -bn1 | grep "Cpu(s)"
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –Ω–∏–∑–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
```

---

## –≠—Ç–∞–ø 9: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 9.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é SSH
sudo cat /etc/ssh/sshd_config | grep -E "PermitRootLogin|PasswordAuthentication"
# –û–∂–∏–¥–∞–µ—Ç—Å—è: PermitRootLogin no, PasswordAuthentication no

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –∫–ª—é—á—É
ssh k8s-admin@10.246.10.250
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –ø–∞—Ä–æ–ª—è
```

### 9.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ firewall

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å firewall
sudo ufw status
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –∞–∫—Ç–∏–≤–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ firewall
sudo ufw status numbered
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è SSH –∏ Kubernetes –ø–æ—Ä—Ç–æ–≤
```

---

## –≠—Ç–∞–ø 10: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### 10.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
./scripts/validate-vm-template.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—á–µ—Ç
cat /tmp/cleanup-report-*.txt
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –æ—Ç—á–µ—Ç –æ–± —É—Å–ø–µ—à–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```

### 10.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ Production

- [ ] ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] ‚úÖ –í–µ—Ä—Å–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- [ ] ‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [ ] ‚úÖ –°–µ—Ç–µ–≤–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] ‚úÖ Cloud-init –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- [ ] ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- [ ] ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- [ ] ‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: VM –Ω–µ –∫–ª–æ–Ω–∏—Ä—É–µ—Ç—Å—è
**–°–∏–º–ø—Ç–æ–º—ã:** –û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ Template
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Template –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–∫–ª—é—á–µ–Ω
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ Template
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–µ –º–µ—Å—Ç–æ –≤ datastore

### –ü—Ä–æ–±–ª–µ–º–∞ 2: cloud-init –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–°–∏–º–ø—Ç–æ–º—ã:** VM –∫–ª–æ–Ω–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å cloud-init –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ cloud-init: `sudo journalctl -u cloud-init`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ cloud-init —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Template

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Kubernetes –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
**–°–∏–º–ø—Ç–æ–º—ã:** containerd –∏–ª–∏ kubelet –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `sudo journalctl -u containerd`

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –°–µ—Ç–µ–≤–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–°–∏–º–ø—Ç–æ–º—ã:** –ù–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ SSH –∏–ª–∏ ping
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ –≤ vSphere
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é netplan
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ NSX-T

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Template –≥–æ—Ç–æ–≤, –µ—Å–ª–∏:**
- ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Cloud-init –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è kubeadm

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. Template –≥–æ—Ç–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Production –∫–ª–∞—Å—Ç–µ—Ä–∞
2. –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å Control Plane –∏ Worker –Ω–æ–¥—ã
3. –ü—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞

---

**–í–∞–∂–Ω–æ:** –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Template –≤ Production!
